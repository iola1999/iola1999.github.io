---
layout: post
title:  浙江闪讯路由器不完全使用指北
date:   2019-03-20 14:00:00 +0800
categories: 折腾
tag: 路由器
---

* content
{:toc}


这是2017年写在博客上的一篇短文，最近指导同学安装闪讯路由器，顺便完善下吧。


原内容			{#original}
====================================

首先，这只是开个题。不久会慢慢更新。

1.
首先闪讯账号和密码并非真正的宽带账号和密码，而是需要经过算法转换成可用的账密的。因此就有了闪讯路由器的说法，相较于普通路由器，这些路由器内置了这样的算法，可以直接用于模拟闪讯客户端拨号。

2.
通常来说这种可以直接拨号的路由器都是刷了第三方固件的（类似手机系统），有许多路由器都可以刷这样的第三方固件。如果想了解相关信息，请搜索“闪讯
斐讯
华硕固件Pandora”等关键词。

3.
当然几年前的那些最常见的路由器（多为TP，水星，Tenda等），这些路由器没法刷第三方固件，也就无法直接拨号。但是我们可以使用其他设备上的闪讯专用路由器管理工具在本地计算好真实账密后直接传给路由器进行拨号。显然这样的路由器使用起来体验并不会很好，因为我们需要每天都拿出手机（或电脑）来进行拨号。不过好处是这样的路由器真的很便宜。

4.
路由器能不能（长期）稳定使用呢？
关于这个问题，要分几种情况来讨论，也就是说在哪些情况下路由器没法正常使用了：

A. 心跳验证
所谓心跳验证，就是电信为了检测你是不是真的在用它官方的“闪讯客户端”进行拨号而要求这货每隔一段时间向其服务器发个包表示这程序还活着。如果我们使用刷了第三方固件的路由器的话，通常可以手动为路由器添加模拟客户端软件自动发送心跳包的插件，具体搜索“闪讯路由器
心跳插件”。而当我们使用古老的路由器的话，是无法为其添加心跳插件的。所以这里有个（不知道能用多久的）套路，就是在Mac的闪讯客户端上把我们的闪讯账号挂一段时间（几十分钟），即可解除电信方面对我们这个账号的心跳检测。没有苹果电脑的话可以开虚拟机（网络类型选择桥接）。

B. 闪讯登录方式升级
登录方式升级，就是登录方式升级咯。据官方消息，2017秋可能会把闪讯的密码登录改成扫码登录，路由器能不能用就取决于之前拨号方式会不会被封杀了。
其实暂时想不到有什么其他问题了2333


近期的补充			{#more}
====================================
内容有点多，懒得整理了，直接粘贴上来。

讲一点路由器的选择吧，
如果不追求网络质量，负载设备比较少，或者快毕业了想省钱随便买一个的话，十分推荐硬改tplink，淘宝搜一搜，二三十块包邮的都有。不过这种设备成色大部分比较一般。
这些便宜机器性能一般，无线网络方面仅支持 2.4G 容易干扰。但是拖几个设备看看网页绝对是够了

稍微高一些的选择是斐讯的k1 k1s k2（其实只是外观不一样），联想newifi(Y1 Y1S)，这类选择很多，全新价格差不多都在 60~100 这个范围。
优势是处理器性能好一些，无线上支持了 5G，抗干扰能力稍好。
几乎没什么缺点，宿舍几个人一起用，或者有游戏需求，选这种是最合适的。还有就是外观上高档一点。。。新一些。小米路由器百元左右产品也是这个档次的选择。原生小米路由器系统也可以拨移动或者闪讯的。不过不太推荐。

高端一些的选择 大多是为了全千兆网口，性价比最高的可能就是k2p联发科版吧。作为垃圾佬 我对这部分了解不多。


下面说说系统选择，这个其实你网上搜搜能看到详细介绍。

我自己用的 最多的是老毛子改华硕固件、openwrt 固件。
前者就是楼上有人问的 pandavan，这个优点在于配置上比较简洁，功能也很全面贴心。恩山地址：
https://www.right.com.cn/forum/thread-161324-1-1.html

openwrt 对小白用户不太友好，但是配置上之后 使用时倒也不用关心这个问题。
稳定性上两者没太大差别。。。看自己喜好吧



？:
路由器接上 算校园网的时间吗

宽带时间没有限制


？:
第二天网恢复之后，会直接有Wi-Fi吗还是要再重新设置

移动宽带是固定密码的，不用管。
闪讯如果你是动态密码，失效后 下次拨号时需要重新设置一次密码。已固定密码的不用管，自动重连。



？:刷固件后怎样配置？

pandavan
闪讯：WAN口选择pppoe协议，下面填用户名密码，底部有个闪讯协议，选择浙江。保存就可以了
移动：协议用l2tp，服务器192.168.113.1 然后下面填账号密码，底部闪讯协议不用选。保存后，通过路由器访问一下移动的认证页面(背景是图书馆那个)，登录一次后理论上l2tp这边也拨号成功了。以后不需要每次去认证，应该能自动连上。

openwrt
移动：复杂一点，需要自己装xl2tpd，新建一个l2tp的接口后，将它拉到wan那个接口(dhcp协议)同一个防火墙里，后面一样。
闪讯：需要用winscp等软件，将 sxplugin.so 放到pppd的目录下，修改 /etc/config/network  加上拨号参数调用这个插件。这个 sxplugin.so 文件其实放其他位置也可以。比如有些openwrt魔改的固件(小米路由器等)，pppd目录没有写权限，可以把它放storage等目录下，network文件里相应地改一下就好了。


所以显然pandavan用起来简单得多，功能也比较丰富。
但是openwrt可以自定义的东西多一些。比如闪讯可以多拨。。。
配置上有问题可以问我，有机器时会在群里现场演示一遍。

闪讯最好固定密码再用。不想去武林广场的话，可以找电信的人py




？:怎样刷固件？

一般的思路是 获取 root（登录 ssh），写入 breed（不怕死可以跳过这一步），去 breed 上传、写入固件（没刷 breed 的话就是在 ssh 里直接 mtd write 写入固件）。
对于具体的机型，可以在网上搜索，一般都会有相关教程。也可以淘宝买，让商家刷好 pandavan（改华硕）或者 openwrt